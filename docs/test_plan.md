# PRD 기반 테스트 계획

본 문서는 제품 요구사항(PRD)을 토대로 Kiko 프로젝트에서 검증해야 할 기능을 테스트 카테고리별로 정리한 것입니다. 각 테스트는 구현 단계에서 TDD 방식을 통해 작성되며, 아래 검증 기준을 만족해야 합니다.

| 테스트 카테고리 | 기능 설명 | 검증 기준 |
| -------------- | -------- | -------- |
| **STT 서비스** | 음성 파일 업로드 후 전사 ID 반환 | - 200 응답 시 전사 ID가 반환된다.<br>- 실패 응답 시 `VitoAPIError` 예외가 발생한다. |
| **STT 서비스** | 전사 결과 조회 | - 200 응답 시 텍스트 데이터가 반환된다.<br>- 실패 응답 시 예외가 발생한다. |
| **스크립트 인터랙션** | 변환된 스크립트에서 단어 클릭 시 의미 제공 | - 단어 클릭 이벤트가 사전 API 호출 또는 로컬 데이터 조회를 통해 뜻과 예문을 표시한다. |
| **단어장 관리** | 모르는 단어 저장 및 조회 | - 저장 버튼 클릭 시 단어가 사용자 단어장에 추가된다.<br>- 단어장 조회 시 저장된 단어 목록이 반환된다. |
| **오디오 플레이어** | 재생, 일시 정지, 반복 기능 | - 각 버튼 동작 후 플레이어 상태가 기대와 일치한다. |
| **번역 서비스** | 스크립트 번역 제공 | - 번역 요청 시 결과가 화면에 표시된다. |

## FastAPI 엔드포인트 테스트

`tests/test_app.py` 파일에서는 다음과 같은 시나리오를 검증한다.

| 엔드포인트 | 성공 조건 | 실패 조건 |
| ---------- | -------- | -------- |
| `POST /auth/login` | 유효한 `username`과 `password`를 전송하면 토큰이 반환된다. | 필드 누락 시 `422` 응답을 받는다. |
| `GET /episodes` | 에피소드 목록이 배열 형태로 반환된다. | - |
| `GET /episodes/{id}` | 존재하는 ID 요청 시 `200`과 개별 에피소드가 반환된다. | 존재하지 않는 ID일 경우 `404` 응답을 받는다. |
| `POST /transcribe` | 파일 업로드 시 전사 ID가 `200`과 함께 반환된다. | 파일 누락 시 `422` 오류가 발생한다. |
| `GET /transcribe/{id}` | 저장된 전사 텍스트가 `200`으로 반환된다. | - |
| `POST /vocab` | 올바른 단어 정보 전송 시 저장된 단어가 반환된다. | 필드가 부족하면 `422` 응답을 받는다. |
| `GET /vocab` | 저장된 단어 목록이 배열로 반환된다. | - |
| `POST /translate` | 텍스트를 전송하면 번역 결과가 반환된다. | API 키 누락 등 오류 시 `500` 응답을 받는다. |
| `GET /dictionary/{word}` | 단어를 조회하면 영어 의미가 반환된다. | Jisho API 실패 시 `500` 응답을 받는다. |

이러한 테스트는 `pytest`와 `fastapi.testclient`를 사용하여 실행되며, CI 환경에서 `pytest -q` 명령으로 검증한다.

향후 구현되는 기능들은 위 검증 기준을 만족하도록 테스트 케이스를 추가하여 제품 품질을 보장합니다.
